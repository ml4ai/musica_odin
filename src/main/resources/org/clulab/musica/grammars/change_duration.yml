
vars: org/clulab/musica/grammars/triggers.yml


rules:

  - name: changeduration-1
    label: ${label}
    example: "Lengthen the half note in measure 2 to a whole note"
    priority: ${rulepriority}
    type: token
    pattern: |
      (?<trigger>[word=/(?i)^${change_duration_triggers}/])
      (@note:Note|@rest:Rest|@pitchsequence:PitchSequence|@everything:Everything)
      ([]? @onset:Onset)? (to (@note:Note|@rest:Rest))?

  - name: changeduration-2
    label: ${label}
    example: "Lengthen the note in measure 2 from a half note to a whole note"
    priority: ${rulepriority}
    type: token
    pattern: |
      (?<trigger>[word=/(?i)^(${change_duration_triggers})/])
      (@note:Note|@rest:Rest|@pitchsequence:PitchSequence|@everything:Everything)
      ([]? @onset:Onset)? from (@note:Note|@rest:Rest|@pitchsequence:PitchSequence) ((to|into)
      (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))?

#  - name: changeduration-2
#    label: ${label}
#    example: "Lengthen the note in measure 2 from a half note to a whole note"
#    priority: ${rulepriority}
#    type: token
#    pattern: |
#      (?<trigger>[word=/(?i)^(${change_duration_triggers})/])
#      (@note:Note|@rest:Rest|@pitchsequence:PitchSequence|@everything:Everything)
#      ((@locationrel:LocationRel (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))|
#      ([]? @locationabs:LocationAbs))
#      ([]? @onset:Onset)? from (@note:Note|@rest:Rest|@pitchsequence:PitchSequence) ((to|into)
#      (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))?

  - name: changeduration-3-passive
    label: ${label}
    example: "The half note is shortened in beat 1 of measure 1 to a quarter note"
    priority: ${rulepriority}
    type: token
    pattern: |
      (@note:Note|@rest:Rest|@pitchsequence:PitchSequence) []? [word=/^${aux_be}/]
      (?<trigger>[word=/(?i)^${change_duration_triggers}/]) ([]? @onset:Onset)?
      (from (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))?
      (to (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))? ([]? @onset:Onset)?

  - name: changeduration-4-passive
    label: ${label}
    example: "The quarter note in beat 1 of measure 1 is shortened to an eighth note"
    priority: ${rulepriority}
    type: token
    pattern: |
      (@note:Note|@rest:Rest|@pitchsequence:PitchSequence) ([]? @onset:Onset)? []? [word=/^${aux_be}/]
      (?<trigger>[word=/(?i)^${change_duration_triggers}/]) (from (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))?
      (to (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))?

  - name: changeduration-5-with-appositive
    label: ${label}
    example: "In beat 1 of measure 1, shorten the half rest to a quarter rest"
    priority: ${rulepriority}
    type: token
    pattern: |
      @onset:Onset [tag=/,/] (?<trigger>[word=/(?i)^${change_duration_triggers}/])
      (@note:Note|@rest:Rest|@pitchsequence:PitchSequence)
      (from (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))?
      ((to|into) (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))?

  - name: changeduration-6-passive-with-appositive
    label: ${label}
    example: "In the 3rd beat of the second measure, the quarter note should be lengthened to a half note"
    type: token
    pattern: |
      @onset:Onset [tag=/,/] (@note:Note|@rest:Rest|@pitchsequence:PitchSequence) should? [word=/^(${aux_be})/]
      (?<trigger>[word=/(?i)^${change_duration_triggers}/]) (from (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))?
      ((to|into) (@note:Note|@rest:Rest|@pitchsequence:PitchSequence))?

#  - name: ChangeDuration-rule-2
#    label: ${label}
#    example: "Lengthen the note in measure 2 from a half note to a whole note"
#    priority: ${rulepriority}
#    pattern: |
#      trigger = (?<trigger>[word=/(?i)^${change_duration_triggers}/])
#      onset: Onset? = >nmod_in
#      note_generic: Note = >dobj
#      note_original: Note? = >nmod_in? >nmod_from
#      note_changed: Note? = >nmod_in? >nmod_from >nmod_to