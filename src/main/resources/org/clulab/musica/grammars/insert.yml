
vars: org/clulab/musica/grammars/triggers.yml


rules:

    - name: insert-1
      label: ${label}
      priority: ${rulepriority}
      example: "Insert an A quarter note after the D in measure 3"
      type: token
      pattern: |
        (?<trigger>[word=/(?i)^(${insert_triggers})/]) (@note:Note|@chord:Chord|@pitchsequence:PitchSequence)
        (@locationrel:Locationrel|@locationabs:Locationabs)? (@note:Note|@chord:Chord|@pitchsequence:PitchSequence)?
        ([]? @onset:Onset)?
#        (?<trigger>[word=/(?i)^${insert_triggers}/]) (@note:Note|@chord:Chord|@pitchsequence:PitchSequence) []?
#        (@locationrel:Locationrel|@locationabs:Locationabs)? (@note:Note|@chord:Chord|@pitchsequence:PitchSequence)?
#        ([]? @onset:Onset)?

    - name: insert-1-test
      label: ${label}
      priority: ${rulepriority}
      type: token
      pattern: |
        (?<trigger>[word=/(?i)^(${insert_triggers})/]) @note:Note []? @locationabs:Locationabs

    - name: insert-2-passive
      label: ${label}
      priority: ${rulepriority}
      example: "An A quarter note is inserted after the D in measure 3"
      type: token
      pattern: |
        (@note:Note|@chord:Chord|@pitchsequence:PitchSequence) should? [word=/(?i)^(${aux_be})/]
        (?<trigger>[word=/(?i)^(${insert_triggers})/]) (@locationrel:Locationrel|([]? @locationabs:Locationabs))?
        (@note:Note|@chord:Chord|@pitchsequence:PitchSequence)? ([]? @onset:Onset)?

    - name: insert-3
      label: ${label}
      priority: ${rulepriority}
      example: "Insert a quarter note and a quarter rest after the last eighth note"
      type: token
      pattern: |
        (?<trigger>[word=/(?i)^(${insert_triggers})/]) (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure)
        (and (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure))?
        (@locationrel:Locationrel (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure)
        (and (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure))? []? @onset:Onset?)?

    - name: insert-4
      label: ${label}
      priority: ${rulepriority}
      example: "Insert a quarter note at the end of the last measure"
      type: token
      pattern: |
        (?<trigger>[word=/(?i)^(${insert_triggers})/]) (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure)
        (and (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure))?
        @locationabs:Locationabs (([]? @onset:Onset)|@pitchsequence:PitchSequence)?
#        (?<trigger>[word=/(?i)^${insert_triggers}/]) (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure)
#        (and (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure))? (at|to)?
#        @locationabs:Locationabs (([]? @onset:Onset)|@pitchsequence:PitchSequence)?

# todo: should be able to be combined with insert 3; testing separately
#    - name: insert-5-between
#      label: ${label}
#      priority: ${rulepriority}
#      example: "Add a D eighth note between the C half note and the D quarter note"
#      type: token
#      pattern: |
#        (?<trigger>[word=/(?i)^${insert_triggers}/]) (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure)
#        (and (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure))?
#        (@locationrel:Locationrel (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure)
#        and (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure) []? @onset:Onset?)?

    - name: insert-5
      label: ${label}
      priority: ${rulepriority}
      example: "At the start of the second measure, add a quarter note"
      type: token
      pattern: |
        @locationabs:Locationabs (@pitchsequence:PitchSequence)? (@onset:Onset)? (?<trigger>[word=/(?i)^(${insert_triggers})/])
        (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure)

    - name: insert-6-passive
      label: ${label}
      priority: ${rulepriority}
      example: "At the start of the second measure, a quarter note should be added"
      type: token
      pattern: |
        @locationabs:Locationabs (of @pitchsequence:PitchSequence)? (@onset:Onset)?
        (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence|@measure:Measure) (should)?
        [word=/^(${aux_be})/] (?<trigger>[word=/(?i)^(${insert_triggers})/])

#    - name: insert-6
#      label: ${label}
#      priority: ${rulepriority}
#      example:



#    - name: insert-1
#      label: Insert
#      priority: 3
#      pattern: |  # what is amod or compound?
#        trigger = [word=/(?i)^note/]
#        duration: Duration? = >/(amod|compound)/
#        pitch: Pitch? = >/(amod|compound)/
#        specifier: Specifier? = >det