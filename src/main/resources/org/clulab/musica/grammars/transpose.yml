
vars: org/clulab/musica/grammars/triggers.yml


rules:

   - name: Transpose-rule-1
     label: ${label}
     priority: ${rulepriority}
     type: token
     pattern: |
       (?<trigger>[word=/(?i)^${transpose_triggers}/]) (@note:Note|@chord:Chord)
       ([]? @onset:Onset)? @direction:Direction @step:Step

   - name: Transpose-rule-2
     label: ${label}
     priority: ${rulepriority}
     example: "Transpose all the notes up 5 half steps in measure 1."
     type: token
     pattern: |
       (?<trigger>[word=/(?i)^${transpose_triggers}/]) (@note:Note|@chord:Chord)
       @direction:Direction @step:Step ([]? @onset:Onset)?

   # todo: add specificity to avoid things like 'change the whole note to a half note'
   - name: Transpose-rule-3
     label: ${label}
     priority: ${rulepriority}
     example: "Move the G quarter note to the F above it"
     type: token
     pattern: |
       (?<trigger>[word=/(?i)^${transpose_triggers}/]) (@note:Note|@chord:Chord)
       (@direction:Direction)? to (@note:Note|@pitch:Pitch|@chord:Chord) @locationrel:Locationrel?

   - name: Transpose-rule-passive
     label: ${label}
     priority: ${rulepriority}
     example: "The first quarter note in measure 1 is transposed down 2 steps"
     type: token
     pattern: |
       @note:Note ([]? @onset:Onset)? []? [word=/^${aux_be}/]
       (?<trigger>[word=/(?i)^${transpose_triggers}/]) (@direction:Direction)?  @step:Step

   - name: Transpose-rule-everything
     label: ${label}
     priority: ${rulepriority}
     example: "Transpose all the notes up 5 half steps in measure 1."
     type: token
     pattern: |
       (?<trigger>[word=/(?i)^${transpose_triggers}/])
       @everything:Everything @direction:Direction @step:Step ([]? @onset:Onset)?
