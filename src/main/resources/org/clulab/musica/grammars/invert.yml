
vars: org/clulab/musica/grammars/triggers.yml


rules:

  - name: invert-1
    label: ${label}
    priority: ${rulepriority}
    example: "Invert the first measure around middle C"
    type: token
    pattern: |
      (?<trigger>[word=/(?i)^(${invert_triggers})/])
      (@everything:Everything|@note:Note|@chord:Chord|@measure:Measure)
      @location:Location? (around (@note:Note|@pitch:Pitch))?

  - name: invert-2-location-at-start
    label: ${label}
    priority: ${rulepriority}
    example: "In the first measure, invert all the notes around D4"
    type: token
    pattern: |
      (@location:Location [tag=/,/]?) (?<trigger>[word=/(?i)^(${invert_triggers})/])
      (@everything:Everything|@note:Note|@chord:Chord) (around (@note:Note|@pitch:Pitch))?

  - name: invert-3-passive
    label: ${label}
    priority: ${rulepriority}
    example: "The first measure should be inverted around middle C"
    type: token
    pattern: |
      (@note:Note|@everything:Everything|@measure:Measure|@chord:Chord) @location:Location? [word=/^(${modals})/]
      to? [word=/^(${aux_be})/] (?<trigger>[word=/^(${invert_triggers})/]) (around (@note:Note|@pitch:Pitch))?

  - name: invert-4-passive-location-at-start
    label: ${label}
    priority: ${rulepriority}
    example: "In the first measure, everything should be inverted around A4"
    type: token
    pattern: |
      (@location:Location [tag=/,/]?) (@note:Note|@everything:Everything|@measure:Measure|@chord:Chord)
      [word=/^(${modals})/] to? [word=/^(${aux_be})/] (?<trigger>[word=/^(${invert_triggers})/])
      (around (@note:Note|@pitch:Pitch))?