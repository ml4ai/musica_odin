
vars: org/clulab/musica/grammars/triggers.yml


rules:

  # works for both active and passive
  - name: move-0-syntax-that-is-in
    label: ${label}
    priority: ${rulepriority}
    example: "Move the quarter note that is in the first measure to the end of the second measure"
    pattern:
      trigger = [word=/(?i)^(${move_triggers})/]
      sourceEntity:EntityMusic = >/dobj|nsubjpass/
      sourceLocation:Location = >/dobj|nsubjpass/ <nsubj (>/nmod_in|nmod_at/)?
      destLocation:Location? = (>dobj <nsubj (>/nmod_in|nmod_at/)?)? >/nmod_to|nmod_into|nmod_at/

#  - name: move-1
#    label: ${label}
#    priority: ${rulepriority}
#    example: "Move the D in the first measure to the end of measure 5"
#    type: token
#    action: move2Convert
#    pattern: |
#      (?<trigger>[word=/(?i)^(${move_triggers})/]) (@note:Note|@chord:Chord|@rest:Rest|@pitchsequence:PitchSequence)
#      ((in|from) @onset:Onset)? ((to|into) (@locationrel:LocationRel)? []? @onset:Onset)?

#  - name: move-1
#    label: ${label}
#    priority: ${rulepriority}
#    example: "Move the D in the first measure to the end of measure 5"
#    action: move2Convert
#    pattern: |
#      trigger = [word=/(?i)^(${move_triggers})/]
#      musicalEntity:EntityMusic = >dobj
#      sourceLocation:Location? = >nmod_in
#      destLocation:Location? = >nmod_to

  - name: move-3-rel-loc
    label: ${label}
    priority: ${rulepriority}
    example: "Put the first C on top of the G"
    type: token
    pattern: |
      (?<trigger>[word=/(?i)^(${move_triggers})/]) (@musicalEntity:EntityMusic)
      @sourceLocation:Location? @destLocation:Location?

  - name: move-4-earlier-later
    label: ${label}
    priority: ${rulepriority}
    example: "Move the C quarter note two measures to the right"
    type: token
    pattern: |
      (?<trigger>[word=/(?i)^(${move_triggers})/]) (@everything:Everything|@musicalEntity:EntityMusic)
      @timestep:TimeStep